<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NamuPaiai_Wasserstandsanzeige_MQTT: /home/kloenk/.platformio/packages/framework-arduinoespressif8266/tools/sdk/ssl/bearssl/src/aead/gcm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NamuPaiai_Wasserstandsanzeige_MQTT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f00e418d171e49b17445b65571a8f367.html">.platformio</a></li><li class="navelem"><a class="el" href="dir_9c890f64469c51741ed59309dac154b6.html">packages</a></li><li class="navelem"><a class="el" href="dir_2f2b8fdc9e3a4daa689fa559edc2cfe3.html">framework-arduinoespressif8266</a></li><li class="navelem"><a class="el" href="dir_9cc1b10cf4616ff2fa9e7a7f19cbe10c.html">tools</a></li><li class="navelem"><a class="el" href="dir_b406ea4600393cb66f11707d56d93d0b.html">sdk</a></li><li class="navelem"><a class="el" href="dir_0b0a637845ba43964bde89b86ab846e9.html">ssl</a></li><li class="navelem"><a class="el" href="dir_4fddf90c78890527e4e584bd7ee88b52.html">bearssl</a></li><li class="navelem"><a class="el" href="dir_021a61e1412f675177b873e5ec8bda07.html">src</a></li><li class="navelem"><a class="el" href="dir_8c303b66ee89dca78e33919e9d8b538c.html">aead</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gcm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="inner_8h_source.html">inner.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8327731877e08c333145ee981160210a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a8327731877e08c333145ee981160210a">br_gcm_init</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#a8934ac58af503220bfb6e6cbc2cfb209">br_block_ctr_class</a> **bctx, <a class="el" href="ssl_2bearssl_2inc_2bearssl__hash_8h.html#a06b9d6420d8038e78efbb53fb4a26eae">br_ghash</a> gh)</td></tr>
<tr class="memdesc:a8327731877e08c333145ee981160210a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a GCM context.  <a href="#a8327731877e08c333145ee981160210a">More...</a><br /></td></tr>
<tr class="separator:a8327731877e08c333145ee981160210a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73538c634b2825886f481d378619f76a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a73538c634b2825886f481d378619f76a">br_gcm_reset</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *iv, size_t len)</td></tr>
<tr class="memdesc:a73538c634b2825886f481d378619f76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a GCM context.  <a href="#a73538c634b2825886f481d378619f76a">More...</a><br /></td></tr>
<tr class="separator:a73538c634b2825886f481d378619f76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a0d62f110f27cd3b59e4b4c5c0c52a98f">br_gcm_aad_inject</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *data, size_t len)</td></tr>
<tr class="memdesc:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject additional authenticated data into GCM.  <a href="#a0d62f110f27cd3b59e4b4c5c0c52a98f">More...</a><br /></td></tr>
<tr class="separator:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea28ef8cd39d21b2be2110d80390903"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#acea28ef8cd39d21b2be2110d80390903">br_gcm_flip</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx)</td></tr>
<tr class="memdesc:acea28ef8cd39d21b2be2110d80390903"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish injection of additional authenticated data into GCM.  <a href="#acea28ef8cd39d21b2be2110d80390903">More...</a><br /></td></tr>
<tr class="separator:acea28ef8cd39d21b2be2110d80390903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d1304725168ed2c4efa1bc58aef56ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a5d1304725168ed2c4efa1bc58aef56ea">br_gcm_run</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, int encrypt, void *data, size_t len)</td></tr>
<tr class="memdesc:a5d1304725168ed2c4efa1bc58aef56ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt some data with GCM.  <a href="#a5d1304725168ed2c4efa1bc58aef56ea">More...</a><br /></td></tr>
<tr class="separator:a5d1304725168ed2c4efa1bc58aef56ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c0b986a690b91966627dd53b9b60af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#ae7c0b986a690b91966627dd53b9b60af">br_gcm_get_tag</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, void *tag)</td></tr>
<tr class="memdesc:ae7c0b986a690b91966627dd53b9b60af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute GCM authentication tag.  <a href="#ae7c0b986a690b91966627dd53b9b60af">More...</a><br /></td></tr>
<tr class="separator:ae7c0b986a690b91966627dd53b9b60af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0217d2166e701a8622797289eb02530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#ae0217d2166e701a8622797289eb02530">br_gcm_get_tag_trunc</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, void *tag, size_t len)</td></tr>
<tr class="memdesc:ae0217d2166e701a8622797289eb02530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute GCM authentication tag (with truncation).  <a href="#ae0217d2166e701a8622797289eb02530">More...</a><br /></td></tr>
<tr class="separator:ae0217d2166e701a8622797289eb02530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625f24f07e45a064e0a61d2dc78105e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a625f24f07e45a064e0a61d2dc78105e0">br_gcm_check_tag_trunc</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag, size_t len)</td></tr>
<tr class="memdesc:a625f24f07e45a064e0a61d2dc78105e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check GCM authentication tag (with truncation).  <a href="#a625f24f07e45a064e0a61d2dc78105e0">More...</a><br /></td></tr>
<tr class="separator:a625f24f07e45a064e0a61d2dc78105e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#aa2db733cfaf0aeaf61f1a3a375e8d860">br_gcm_check_tag</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag)</td></tr>
<tr class="memdesc:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check GCM authentication tag.  <a href="#aa2db733cfaf0aeaf61f1a3a375e8d860">More...</a><br /></td></tr>
<tr class="separator:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a62a1a13b2d2f6c51a6b35cf3e4f18cac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a> <a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a2044a9a96fb01fb0e202a1ebcc85ba8d">br_gcm_vtable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcm_8c.html#a62a1a13b2d2f6c51a6b35cf3e4f18cac">PROGMEM</a></td></tr>
<tr class="separator:a62a1a13b2d2f6c51a6b35cf3e4f18cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0d62f110f27cd3b59e4b4c5c0c52a98f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d62f110f27cd3b59e4b4c5c0c52a98f">&#9670;&nbsp;</a></span>br_gcm_aad_inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_aad_inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject additional authenticated data into GCM. </p>
<p>The provided data is injected into a running GCM computation. Additional data must be injected <em>before</em> the call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#acea28ef8cd39d21b2be2110d80390903" title="Finish injection of additional authenticated data into GCM.">br_gcm_flip()</a></code>. Additional data can be injected in several chunks of arbitrary length; the maximum total size of additional authenticated data is 2^64-1 bits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">data</td><td>pointer to additional authenticated data. </td></tr>
    <tr><td class="paramname">len</td><td>length of additional authenticated data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa2db733cfaf0aeaf61f1a3a375e8d860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2db733cfaf0aeaf61f1a3a375e8d860">&#9670;&nbsp;</a></span>br_gcm_check_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_gcm_check_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check GCM authentication tag. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae7c0b986a690b91966627dd53b9b60af" title="Compute GCM authentication tag.">br_gcm_get_tag()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with (16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="a625f24f07e45a064e0a61d2dc78105e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625f24f07e45a064e0a61d2dc78105e0">&#9670;&nbsp;</a></span>br_gcm_check_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_gcm_check_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check GCM authentication tag (with truncation). </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae0217d2166e701a8622797289eb02530" title="Compute GCM authentication tag (with truncation).">br_gcm_get_tag_trunc()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<p>Tag length MUST be 16 bytes or less. The normal GCM tag length is 16 bytes. See <code>br_check_tag_trunc()</code> for some discussion on the potential perils of truncating authentication tags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="acea28ef8cd39d21b2be2110d80390903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea28ef8cd39d21b2be2110d80390903">&#9670;&nbsp;</a></span>br_gcm_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_flip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish injection of additional authenticated data into GCM. </p>
<p>This function MUST be called before beginning the actual encryption or decryption (with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a5d1304725168ed2c4efa1bc58aef56ea" title="Encrypt or decrypt some data with GCM.">br_gcm_run()</a></code>), even if no additional authenticated data was injected. No additional authenticated data may be injected after this function call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae7c0b986a690b91966627dd53b9b60af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c0b986a690b91966627dd53b9b60af">&#9670;&nbsp;</a></span>br_gcm_get_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_get_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute GCM authentication tag. </p>
<p>Compute the GCM authentication tag. The tag is a 16-byte value which is written in the provided <code>tag</code> buffer. This call terminates the GCM run: no data may be processed with that GCM context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> is called to initiate a new GCM run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#aa2db733cfaf0aeaf61f1a3a375e8d860" title="Compute and check GCM authentication tag.">br_gcm_check_tag()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag (16 bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae0217d2166e701a8622797289eb02530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0217d2166e701a8622797289eb02530">&#9670;&nbsp;</a></span>br_gcm_get_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_get_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute GCM authentication tag (with truncation). </p>
<p>This function is similar to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae7c0b986a690b91966627dd53b9b60af" title="Compute GCM authentication tag.">br_gcm_get_tag()</a></code>, except that it allows the tag to be truncated to a smaller length. The intended tag length is provided as <code>len</code> (in bytes); it MUST be no more than 16, but it may be smaller. Note that decreasing tag length mechanically makes forgeries easier; NIST SP 800-38D specifies that the tag length shall lie between 12 and 16 bytes (inclusive), but may be truncated down to 4 or 8 bytes, for specific applications that can tolerate it. It must also be noted that successful forgeries leak information on the authentication key, making subsequent forgeries easier. Therefore, tag truncation, and in particular truncation to sizes lower than 12 bytes, shall be envisioned only with great care.</p>
<p>The tag is written in the provided <code>tag</code> buffer. This call terminates the GCM run: no data may be processed with that GCM context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> is called to initiate a new GCM run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a625f24f07e45a064e0a61d2dc78105e0" title="Compute and check GCM authentication tag (with truncation).">br_gcm_check_tag_trunc()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (16 bytes or less). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8327731877e08c333145ee981160210a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8327731877e08c333145ee981160210a">&#9670;&nbsp;</a></span>br_gcm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#a8934ac58af503220bfb6e6cbc2cfb209">br_block_ctr_class</a> **&#160;</td>
          <td class="paramname"><em>bctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ssl_2bearssl_2inc_2bearssl__hash_8h.html#a06b9d6420d8038e78efbb53fb4a26eae">br_ghash</a>&#160;</td>
          <td class="paramname"><em>gh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a GCM context. </p>
<p>A block cipher implementation, with its initialised context structure, is provided. The block cipher MUST use 16-byte blocks in CTR mode, and its secret key MUST have been already set in the provided context. A GHASH implementation must also be provided. The parameters are linked in the GCM context.</p>
<p>After this function has been called, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> function must be called, to provide the IV for GCM computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">bctx</td><td>block cipher context (already initialised with secret key). </td></tr>
    <tr><td class="paramname">gh</td><td>GHASH implementation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a73538c634b2825886f481d378619f76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73538c634b2825886f481d378619f76a">&#9670;&nbsp;</a></span>br_gcm_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a GCM context. </p>
<p>This function resets an already initialised GCM context for a new computation run. Implementations and keys are conserved. This function can be called at any time; it cancels any ongoing GCM computation that uses the provided context structure.</p>
<p>The provided IV is a <em>nonce</em>. It is critical to GCM security that IV values are not repeated for the same encryption key. IV can have arbitrary length (up to 2^64-1 bits), but the "normal" length is 96 bits (12 bytes).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">iv</td><td>GCM nonce to use. </td></tr>
    <tr><td class="paramname">len</td><td>GCM nonce length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5d1304725168ed2c4efa1bc58aef56ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d1304725168ed2c4efa1bc58aef56ea">&#9670;&nbsp;</a></span>br_gcm_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt some data with GCM. </p>
<p>Data encryption or decryption can be done after <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#acea28ef8cd39d21b2be2110d80390903" title="Finish injection of additional authenticated data into GCM.">br_gcm_flip()</a></code> has been called on the context. If <code>encrypt</code> is non-zero, then the provided data shall be plaintext, and it is encrypted in place. Otherwise, the data shall be ciphertext, and it is decrypted in place.</p>
<p>Data may be provided in several chunks of arbitrary length. The maximum total length for data is 2^39-256 bits, i.e. about 65 gigabytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">encrypt</td><td>non-zero for encryption, zero for decryption. </td></tr>
    <tr><td class="paramname">data</td><td>data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">len</td><td>data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a62a1a13b2d2f6c51a6b35cf3e4f18cac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a1a13b2d2f6c51a6b35cf3e4f18cac">&#9670;&nbsp;</a></span>PROGMEM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a> <a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a2044a9a96fb01fb0e202a1ebcc85ba8d">br_gcm_vtable</a> PROGMEM</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    16,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keyword">const</span> <span class="keywordtype">void</span> *, size_t))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#a73538c634b2825886f481d378619f76a">br_gcm_reset</a>,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keyword">const</span> <span class="keywordtype">void</span> *, size_t))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#a0d62f110f27cd3b59e4b4c5c0c52a98f">br_gcm_aad_inject</a>,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#acea28ef8cd39d21b2be2110d80390903">br_gcm_flip</a>,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, int, <span class="keywordtype">void</span> *, size_t))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#a5d1304725168ed2c4efa1bc58aef56ea">br_gcm_run</a>,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keywordtype">void</span> *))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#ae7c0b986a690b91966627dd53b9b60af">br_gcm_get_tag</a>,</div><div class="line">    (<a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keyword">const</span> <span class="keywordtype">void</span> *))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#aa2db733cfaf0aeaf61f1a3a375e8d860">br_gcm_check_tag</a>,</div><div class="line">    (void (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keywordtype">void</span> *, size_t))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#ae0217d2166e701a8622797289eb02530">br_gcm_get_tag_trunc</a>,</div><div class="line">    (<a class="code" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> (*)(<span class="keyword">const</span> <a class="code" href="structbr__aead__class__.html">br_aead_class</a> **, <span class="keyword">const</span> <span class="keywordtype">void</span> *, size_t))</div><div class="line">        &amp;<a class="code" href="gcm_8c.html#a625f24f07e45a064e0a61d2dc78105e0">br_gcm_check_tag_trunc</a></div><div class="line">}</div><div class="ttc" id="gcm_8c_html_a73538c634b2825886f481d378619f76a"><div class="ttname"><a href="gcm_8c.html#a73538c634b2825886f481d378619f76a">br_gcm_reset</a></div><div class="ttdeci">void br_gcm_reset(br_gcm_context *ctx, const void *iv, size_t len)</div><div class="ttdoc">Reset a GCM context.</div><div class="ttdef"><b>Definition:</b> gcm.c:76</div></div>
<div class="ttc" id="stdint_8h_html_a0238af00180b6d9278fa1c6aa790fdf4"><div class="ttname"><a href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a></div><div class="ttdeci">__uint32_t uint32_t</div><div class="ttdef"><b>Definition:</b> stdint.h:45</div></div>
<div class="ttc" id="gcm_8c_html_aa2db733cfaf0aeaf61f1a3a375e8d860"><div class="ttname"><a href="gcm_8c.html#aa2db733cfaf0aeaf61f1a3a375e8d860">br_gcm_check_tag</a></div><div class="ttdeci">uint32_t br_gcm_check_tag(br_gcm_context *ctx, const void *tag)</div><div class="ttdoc">Compute and check GCM authentication tag.</div><div class="ttdef"><b>Definition:</b> gcm.c:294</div></div>
<div class="ttc" id="structbr__aead__class___html"><div class="ttname"><a href="structbr__aead__class__.html">br_aead_class_</a></div><div class="ttdef"><b>Definition:</b> bearssl_aead.h:181</div></div>
<div class="ttc" id="gcm_8c_html_a0d62f110f27cd3b59e4b4c5c0c52a98f"><div class="ttname"><a href="gcm_8c.html#a0d62f110f27cd3b59e4b4c5c0c52a98f">br_gcm_aad_inject</a></div><div class="ttdeci">void br_gcm_aad_inject(br_gcm_context *ctx, const void *data, size_t len)</div><div class="ttdoc">Inject additional authenticated data into GCM.</div><div class="ttdef"><b>Definition:</b> gcm.c:109</div></div>
<div class="ttc" id="gcm_8c_html_ae7c0b986a690b91966627dd53b9b60af"><div class="ttname"><a href="gcm_8c.html#ae7c0b986a690b91966627dd53b9b60af">br_gcm_get_tag</a></div><div class="ttdeci">void br_gcm_get_tag(br_gcm_context *ctx, void *tag)</div><div class="ttdoc">Compute GCM authentication tag.</div><div class="ttdef"><b>Definition:</b> gcm.c:236</div></div>
<div class="ttc" id="gcm_8c_html_ae0217d2166e701a8622797289eb02530"><div class="ttname"><a href="gcm_8c.html#ae0217d2166e701a8622797289eb02530">br_gcm_get_tag_trunc</a></div><div class="ttdeci">void br_gcm_get_tag_trunc(br_gcm_context *ctx, void *tag, size_t len)</div><div class="ttdoc">Compute GCM authentication tag (with truncation).</div><div class="ttdef"><b>Definition:</b> gcm.c:268</div></div>
<div class="ttc" id="gcm_8c_html_a625f24f07e45a064e0a61d2dc78105e0"><div class="ttname"><a href="gcm_8c.html#a625f24f07e45a064e0a61d2dc78105e0">br_gcm_check_tag_trunc</a></div><div class="ttdeci">uint32_t br_gcm_check_tag_trunc(br_gcm_context *ctx, const void *tag, size_t len)</div><div class="ttdoc">Compute and check GCM authentication tag (with truncation).</div><div class="ttdef"><b>Definition:</b> gcm.c:278</div></div>
<div class="ttc" id="gcm_8c_html_acea28ef8cd39d21b2be2110d80390903"><div class="ttname"><a href="gcm_8c.html#acea28ef8cd39d21b2be2110d80390903">br_gcm_flip</a></div><div class="ttdeci">void br_gcm_flip(br_gcm_context *ctx)</div><div class="ttdoc">Finish injection of additional authenticated data into GCM.</div><div class="ttdef"><b>Definition:</b> gcm.c:147</div></div>
<div class="ttc" id="gcm_8c_html_a5d1304725168ed2c4efa1bc58aef56ea"><div class="ttname"><a href="gcm_8c.html#a5d1304725168ed2c4efa1bc58aef56ea">br_gcm_run</a></div><div class="ttdeci">void br_gcm_run(br_gcm_context *ctx, int encrypt, void *data, size_t len)</div><div class="ttdoc">Encrypt or decrypt some data with GCM.</div><div class="ttdef"><b>Definition:</b> gcm.c:164</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
