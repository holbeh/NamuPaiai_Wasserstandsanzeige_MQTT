<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NamuPaiai_Wasserstandsanzeige_MQTT: br_ssl_server_policy_class_ Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NamuPaiai_Wasserstandsanzeige_MQTT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structbr__ssl__server__policy__class__-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">br_ssl_server_policy_class_ Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="include_2bearssl_2bearssl__ssl_8h_source.html">bearssl_ssl.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a18c30e437ebf8997032487383e6bbbcf"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__ssl__server__policy__class__.html#a18c30e437ebf8997032487383e6bbbcf">context_size</a></td></tr>
<tr class="memdesc:a18c30e437ebf8997032487383e6bbbcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context size (in bytes).  <a href="#a18c30e437ebf8997032487383e6bbbcf">More...</a><br /></td></tr>
<tr class="separator:a18c30e437ebf8997032487383e6bbbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18496cb315d83a1a2a03b309c4b9c0a2"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__ssl__server__policy__class__.html#a18496cb315d83a1a2a03b309c4b9c0a2">choose</a> )(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a14f907edeb9d0b952093a0905a7e3da6">br_ssl_server_context</a> *cc, <a class="el" href="structbr__ssl__server__choices.html">br_ssl_server_choices</a> *choices)</td></tr>
<tr class="memdesc:a18496cb315d83a1a2a03b309c4b9c0a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select algorithms and certificates for this connection.  <a href="#a18496cb315d83a1a2a03b309c4b9c0a2">More...</a><br /></td></tr>
<tr class="separator:a18496cb315d83a1a2a03b309c4b9c0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af58e866b896b9e1e338c842dad393c8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__ssl__server__policy__class__.html#af58e866b896b9e1e338c842dad393c8c">do_keyx</a> )(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, unsigned char *data, size_t *len)</td></tr>
<tr class="memdesc:af58e866b896b9e1e338c842dad393c8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform key exchange (server part).  <a href="#af58e866b896b9e1e338c842dad393c8c">More...</a><br /></td></tr>
<tr class="separator:af58e866b896b9e1e338c842dad393c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7d0bd931147ae3eb65fbb899d14594"><td class="memItemLeft" align="right" valign="top">size_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__ssl__server__policy__class__.html#a9d7d0bd931147ae3eb65fbb899d14594">do_sign</a> )(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, unsigned algo_id, unsigned char *data, size_t hv_len, size_t len)</td></tr>
<tr class="memdesc:a9d7d0bd931147ae3eb65fbb899d14594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a signature (for a ServerKeyExchange message).  <a href="#a9d7d0bd931147ae3eb65fbb899d14594">More...</a><br /></td></tr>
<tr class="separator:a9d7d0bd931147ae3eb65fbb899d14594"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a18496cb315d83a1a2a03b309c4b9c0a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18496cb315d83a1a2a03b309c4b9c0a2">&#9670;&nbsp;</a></span>choose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* br_ssl_server_policy_class_::choose)(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a14f907edeb9d0b952093a0905a7e3da6">br_ssl_server_context</a> *cc, <a class="el" href="structbr__ssl__server__choices.html">br_ssl_server_choices</a> *choices)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select algorithms and certificates for this connection. </p>
<p>This callback function shall fill the provided <code>choices</code> structure with the policy choices for this connection. This entails selecting the cipher suite, hash function for signing the ServerKeyExchange (applicable only to ECDHE cipher suites), and certificate chain to send.</p>
<p>The callback receives a pointer to the server context that contains the relevant data. In particular, the functions <code>br_ssl_server_get_client_suites()</code>, <code>br_ssl_server_get_client_hashes()</code> and <code>br_ssl_server_get_client_curves()</code> can be used to obtain the cipher suites, hash functions and elliptic curves supported by both the client and server, respectively. The <code>br_ssl_engine_get_version()</code> and <code>br_ssl_engine_get_server_name()</code> functions yield the protocol version and requested server name (SNI), respectively.</p>
<p>This function may modify its context structure (<code>pctx</code>) in arbitrary ways to keep track of its own choices.</p>
<p>This function shall return 1 if appropriate policy choices could be made, or 0 if this connection cannot be pursued.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pctx</td><td>policy context. </td></tr>
    <tr><td class="paramname">cc</td><td>SSL server context. </td></tr>
    <tr><td class="paramname">choices</td><td>destination structure for the policy choices. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on error. </dd></dl>

</div>
</div>
<a id="a18c30e437ebf8997032487383e6bbbcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18c30e437ebf8997032487383e6bbbcf">&#9670;&nbsp;</a></span>context_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t br_ssl_server_policy_class_::context_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Context size (in bytes). </p>

</div>
</div>
<a id="af58e866b896b9e1e338c842dad393c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af58e866b896b9e1e338c842dad393c8c">&#9670;&nbsp;</a></span>do_keyx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>(* br_ssl_server_policy_class_::do_keyx)(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, unsigned char *data, size_t *len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform key exchange (server part). </p>
<p>This callback is invoked to perform the server-side cryptographic operation for a key exchange that is not ECDHE. This callback uses the private key.</p>
<p><b>For RSA key exchange</b>, the provided <code>data</code> (of length <code>*len</code> bytes) shall be decrypted with the server's private key, and the 48-byte premaster secret copied back to the first 48 bytes of <code>data</code>.</p>
<ul>
<li>The caller makes sure that <code>*len</code> is at least 59 bytes.</li>
<li>This callback MUST check that the provided length matches that of the key modulus; it shall report an error otherwise.</li>
<li>If the length matches that of the RSA key modulus, then processing MUST be constant-time, even if decryption fails, or the padding is incorrect, or the plaintext message length is not exactly 48 bytes.</li>
<li>This callback needs not check the two first bytes of the obtained pre-master secret (the caller will do that).</li>
<li>If an error is reported (0), then what the callback put in the first 48 bytes of <code>data</code> is unimportant (the caller will use random bytes instead).</li>
</ul>
<p><b>For ECDH key exchange</b>, the provided <code>data</code> (of length <code>*len</code> bytes) is the elliptic curve point from the client. The callback shall multiply it with its private key, and store the resulting X coordinate in <code>data</code>, starting at offset 0, and set <code>*len</code> to the length of the X coordinate.</p>
<ul>
<li>If the input array does not have the proper length for an encoded curve point, then an error (0) shall be reported.</li>
<li>If the input array has the proper length, then processing MUST be constant-time, even if the data is not a valid encoded point.</li>
<li>This callback MUST check that the input point is valid.</li>
</ul>
<p>Returned value is 1 on success, 0 on error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pctx</td><td>policy context. </td></tr>
    <tr><td class="paramname">data</td><td>key exchange data from the client. </td></tr>
    <tr><td class="paramname">len</td><td>key exchange data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on error. </dd></dl>

</div>
</div>
<a id="a9d7d0bd931147ae3eb65fbb899d14594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d7d0bd931147ae3eb65fbb899d14594">&#9670;&nbsp;</a></span>do_sign</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t(* br_ssl_server_policy_class_::do_sign)(<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__ssl_8h.html#a20bd6d3a5ad0396134122e937a960d43">br_ssl_server_policy_class</a> **pctx, unsigned algo_id, unsigned char *data, size_t hv_len, size_t len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a signature (for a ServerKeyExchange message). </p>
<p>This callback function is invoked for ECDHE cipher suites. On input, the hash value or message to sign is in <code>data</code>, of size <code>hv_len</code>; the involved hash function or algorithm is identified by <code>algo_id</code>. The signature shall be computed and written back into <code>data</code>; the total size of that buffer is <code>len</code> bytes.</p>
<p>This callback shall verify that the signature length does not exceed <code>len</code> bytes, and abstain from writing the signature if it does not fit.</p>
<p>The <code>algo_id</code> value matches that which was written in the <code>choices</code> structures by the <code><a class="el" href="structbr__ssl__server__policy__class__.html#a18496cb315d83a1a2a03b309c4b9c0a2" title="Select algorithms and certificates for this connection.">choose()</a></code> callback. This will be one of the following:</p>
<ul>
<li><code>0xFF00 + id</code> for a hash function identifier <code>id</code>. In that case, the <code>data</code> buffer contains a hash value already computed over the data that is to be signed, of length <code>hv_len</code>. The <code>id</code> may be 0 to designate the special MD5+SHA-1 concatenation (old-style RSA signing).</li>
<li>Another value, lower than <code>0xFF00</code>. The <code>data</code> buffer then contains the raw, non-hashed data to be signed (concatenation of the client and server randoms and ECDH parameters). The callback is responsible to apply any relevant hashing as part of the signing process.</li>
</ul>
<p>Returned value is the signature length (in bytes), or 0 on error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pctx</td><td>policy context. </td></tr>
    <tr><td class="paramname">algo_id</td><td>hash function / algorithm identifier. </td></tr>
    <tr><td class="paramname">data</td><td>input/output buffer (message/hash, then signature). </td></tr>
    <tr><td class="paramname">hv_len</td><td>hash value or message length (in bytes). </td></tr>
    <tr><td class="paramname">len</td><td>total buffer length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>signature length (in bytes) on success, or 0 on error. </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/kloenk/.platformio/packages/framework-arduinoespressif8266/tools/sdk/include/bearssl/<a class="el" href="include_2bearssl_2bearssl__ssl_8h_source.html">bearssl_ssl.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
