<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NamuPaiai_Wasserstandsanzeige_MQTT: /home/kloenk/.platformio/packages/framework-arduinoespressif8266/tools/sdk/ssl/bearssl/src/aead/ccm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NamuPaiai_Wasserstandsanzeige_MQTT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f00e418d171e49b17445b65571a8f367.html">.platformio</a></li><li class="navelem"><a class="el" href="dir_9c890f64469c51741ed59309dac154b6.html">packages</a></li><li class="navelem"><a class="el" href="dir_2f2b8fdc9e3a4daa689fa559edc2cfe3.html">framework-arduinoespressif8266</a></li><li class="navelem"><a class="el" href="dir_9cc1b10cf4616ff2fa9e7a7f19cbe10c.html">tools</a></li><li class="navelem"><a class="el" href="dir_b406ea4600393cb66f11707d56d93d0b.html">sdk</a></li><li class="navelem"><a class="el" href="dir_0b0a637845ba43964bde89b86ab846e9.html">ssl</a></li><li class="navelem"><a class="el" href="dir_4fddf90c78890527e4e584bd7ee88b52.html">bearssl</a></li><li class="navelem"><a class="el" href="dir_021a61e1412f675177b873e5ec8bda07.html">src</a></li><li class="navelem"><a class="el" href="dir_8c303b66ee89dca78e33919e9d8b538c.html">aead</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ccm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="inner_8h_source.html">inner.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a66bdfa65912ada1090e19c270f8d4e52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#a66bdfa65912ada1090e19c270f8d4e52">br_ccm_init</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **bctx)</td></tr>
<tr class="memdesc:a66bdfa65912ada1090e19c270f8d4e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a CCM context.  <a href="#a66bdfa65912ada1090e19c270f8d4e52">More...</a><br /></td></tr>
<tr class="separator:a66bdfa65912ada1090e19c270f8d4e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#a3e51083f8533fdd7252df6a0f66ab3a4">br_ccm_reset</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *nonce, size_t nonce_len, <a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a> aad_len, <a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a> data_len, size_t tag_len)</td></tr>
<tr class="memdesc:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a CCM context.  <a href="#a3e51083f8533fdd7252df6a0f66ab3a4">More...</a><br /></td></tr>
<tr class="separator:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">br_ccm_aad_inject</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *data, size_t len)</td></tr>
<tr class="memdesc:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject additional authenticated data into CCM.  <a href="#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">More...</a><br /></td></tr>
<tr class="separator:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#ace507b6c8e6481f2fa5605e9e5ceea84">br_ccm_flip</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx)</td></tr>
<tr class="memdesc:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish injection of additional authenticated data into CCM.  <a href="#ace507b6c8e6481f2fa5605e9e5ceea84">More...</a><br /></td></tr>
<tr class="separator:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541acfeac63435ca9bc8c126e3dda3fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#a541acfeac63435ca9bc8c126e3dda3fe">br_ccm_run</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, int encrypt, void *data, size_t len)</td></tr>
<tr class="memdesc:a541acfeac63435ca9bc8c126e3dda3fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt some data with CCM.  <a href="#a541acfeac63435ca9bc8c126e3dda3fe">More...</a><br /></td></tr>
<tr class="separator:a541acfeac63435ca9bc8c126e3dda3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadde45697aa11481a98fee09791bb8f2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#aadde45697aa11481a98fee09791bb8f2">br_ccm_get_tag</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, void *tag)</td></tr>
<tr class="memdesc:aadde45697aa11481a98fee09791bb8f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute CCM authentication tag.  <a href="#aadde45697aa11481a98fee09791bb8f2">More...</a><br /></td></tr>
<tr class="separator:aadde45697aa11481a98fee09791bb8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bff5243ede843f8a04e98521cfd007b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccm_8c.html#a4bff5243ede843f8a04e98521cfd007b">br_ccm_check_tag</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag)</td></tr>
<tr class="memdesc:a4bff5243ede843f8a04e98521cfd007b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check CCM authentication tag.  <a href="#a4bff5243ede843f8a04e98521cfd007b">More...</a><br /></td></tr>
<tr class="separator:a4bff5243ede843f8a04e98521cfd007b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa52c5f9c1ba4eb7ab7ecdf682cbafb38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">&#9670;&nbsp;</a></span>br_ccm_aad_inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_aad_inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject additional authenticated data into CCM. </p>
<p>The provided data is injected into a running CCM computation. Additional data must be injected <em>before</em> the call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ace507b6c8e6481f2fa5605e9e5ceea84" title="Finish injection of additional authenticated data into CCM.">br_ccm_flip()</a></code>. Additional data can be injected in several chunks of arbitrary length, but the total amount MUST exactly match the value which was provided to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">data</td><td>pointer to additional authenticated data. </td></tr>
    <tr><td class="paramname">len</td><td>length of additional authenticated data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4bff5243ede843f8a04e98521cfd007b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bff5243ede843f8a04e98521cfd007b">&#9670;&nbsp;</a></span>br_ccm_check_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_ccm_check_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check CCM authentication tag. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#aadde45697aa11481a98fee09791bb8f2" title="Compute CCM authentication tag.">br_ccm_get_tag()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with (up to 16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="ace507b6c8e6481f2fa5605e9e5ceea84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace507b6c8e6481f2fa5605e9e5ceea84">&#9670;&nbsp;</a></span>br_ccm_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_flip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish injection of additional authenticated data into CCM. </p>
<p>This function MUST be called before beginning the actual encryption or decryption (with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a541acfeac63435ca9bc8c126e3dda3fe" title="Encrypt or decrypt some data with CCM.">br_ccm_run()</a></code>), even if no additional authenticated data was injected. No additional authenticated data may be injected after this function call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aadde45697aa11481a98fee09791bb8f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadde45697aa11481a98fee09791bb8f2">&#9670;&nbsp;</a></span>br_ccm_get_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t br_ccm_get_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute CCM authentication tag. </p>
<p>Compute the CCM authentication tag. This call terminates the CCM run: all data must have been injected with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a541acfeac63435ca9bc8c126e3dda3fe" title="Encrypt or decrypt some data with CCM.">br_ccm_run()</a></code> (in zero, one or more successive calls). After this function has been called, no more data can br processed; a <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> call is required to start a new message.</p>
<p>The tag length was provided upon context initialisation (last call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code>); it is returned by this function.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a4bff5243ede843f8a04e98521cfd007b" title="Compute and check CCM authentication tag.">br_ccm_check_tag()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag (up to 16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the tag length (in bytes). </dd></dl>

</div>
</div>
<a id="a66bdfa65912ada1090e19c270f8d4e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66bdfa65912ada1090e19c270f8d4e52">&#9670;&nbsp;</a></span>br_ccm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **&#160;</td>
          <td class="paramname"><em>bctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a CCM context. </p>
<p>A block cipher implementation, with its initialised context structure, is provided. The block cipher MUST use 16-byte blocks in CTR + CBC-MAC mode, and its secret key MUST have been already set in the provided context. The parameters are linked in the CCM context.</p>
<p>After this function has been called, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> function must be called, to provide the nonce for CCM computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">bctx</td><td>block cipher context (already initialised with secret key). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3e51083f8533fdd7252df6a0f66ab3a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e51083f8533fdd7252df6a0f66ab3a4">&#9670;&nbsp;</a></span>br_ccm_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int br_ccm_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a>&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a>&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a CCM context. </p>
<p>This function resets an already initialised CCM context for a new computation run. Implementations and keys are conserved. This function can be called at any time; it cancels any ongoing CCM computation that uses the provided context structure.</p>
<p>The <code>aad_len</code> parameter contains the total length, in bytes, of the additional authenticated data. It may be zero. That length MUST be exact.</p>
<p>The <code>data_len</code> parameter contains the total length, in bytes, of the data that will be injected (plaintext or ciphertext). That length MUST be exact. Moreover, that length MUST be less than 2^(8*(15-nonce_len)).</p>
<p>The nonce length (<code>nonce_len</code>), in bytes, must be in the 7..13 range (inclusive).</p>
<p>The tag length (<code>tag_len</code>), in bytes, must be in the 4..16 range, and be an even integer. Short tags mechanically allow for higher forgery probabilities; hence, tag sizes smaller than 12 bytes shall be used only with care.</p>
<p>It is critical to CCM security that nonce values are not repeated for the same encryption key. Random generation of nonces is not generally recommended, due to the relatively small maximum nonce value.</p>
<p>Returned value is 1 on success, 0 on error. An error is reported if the tag or nonce length is out of range, or if the plaintext/ciphertext length cannot be encoded with the specified nonce length.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">nonce</td><td>CCM nonce to use. </td></tr>
    <tr><td class="paramname">nonce_len</td><td>CCM nonce length (in bytes, 7 to 13). </td></tr>
    <tr><td class="paramname">aad_len</td><td>additional authenticated data length (in bytes). </td></tr>
    <tr><td class="paramname">data_len</td><td>plaintext/ciphertext length (in bytes). </td></tr>
    <tr><td class="paramname">tag_len</td><td>tag length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on error. </dd></dl>

</div>
</div>
<a id="a541acfeac63435ca9bc8c126e3dda3fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a541acfeac63435ca9bc8c126e3dda3fe">&#9670;&nbsp;</a></span>br_ccm_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt some data with CCM. </p>
<p>Data encryption or decryption can be done after <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ace507b6c8e6481f2fa5605e9e5ceea84" title="Finish injection of additional authenticated data into CCM.">br_ccm_flip()</a></code> has been called on the context. If <code>encrypt</code> is non-zero, then the provided data shall be plaintext, and it is encrypted in place. Otherwise, the data shall be ciphertext, and it is decrypted in place.</p>
<p>Data may be provided in several chunks of arbitrary length, provided that the total length exactly matches the length provided to the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">encrypt</td><td>non-zero for encryption, zero for decryption. </td></tr>
    <tr><td class="paramname">data</td><td>data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">len</td><td>data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
