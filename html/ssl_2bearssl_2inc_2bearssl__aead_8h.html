<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NamuPaiai_Wasserstandsanzeige_MQTT: /home/kloenk/.platformio/packages/framework-arduinoespressif8266/tools/sdk/ssl/bearssl/inc/bearssl_aead.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NamuPaiai_Wasserstandsanzeige_MQTT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f00e418d171e49b17445b65571a8f367.html">.platformio</a></li><li class="navelem"><a class="el" href="dir_9c890f64469c51741ed59309dac154b6.html">packages</a></li><li class="navelem"><a class="el" href="dir_2f2b8fdc9e3a4daa689fa559edc2cfe3.html">framework-arduinoespressif8266</a></li><li class="navelem"><a class="el" href="dir_9cc1b10cf4616ff2fa9e7a7f19cbe10c.html">tools</a></li><li class="navelem"><a class="el" href="dir_b406ea4600393cb66f11707d56d93d0b.html">sdk</a></li><li class="navelem"><a class="el" href="dir_0b0a637845ba43964bde89b86ab846e9.html">ssl</a></li><li class="navelem"><a class="el" href="dir_4fddf90c78890527e4e584bd7ee88b52.html">bearssl</a></li><li class="navelem"><a class="el" href="dir_703c4ae3352171ef62b7580a70490965.html">inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bearssl_aead.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;<a class="el" href="stdint_8h_source.html">stdint.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="ssl_2bearssl_2inc_2bearssl__block_8h_source.html">bearssl_block.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ssl_2bearssl_2inc_2bearssl__hash_8h_source.html">bearssl_hash.h</a>&quot;</code><br />
</div>
<p><a href="ssl_2bearssl_2inc_2bearssl__aead_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__aead__class__.html">br_aead_class_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context structure for GCM.  <a href="structbr__gcm__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__eax__context.html">br_eax_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context structure for EAX.  <a href="structbr__eax__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__eax__state.html">br_eax_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">EAX captured state.  <a href="structbr__eax__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context structure for CCM.  <a href="structbr__ccm__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a80c48efdbcc8ea8fe621dae2423b10e3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structbr__aead__class__.html">br_aead_class_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a></td></tr>
<tr class="memdesc:a80c48efdbcc8ea8fe621dae2423b10e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class type of an AEAD algorithm.  <a href="#a80c48efdbcc8ea8fe621dae2423b10e3">More...</a><br /></td></tr>
<tr class="separator:a80c48efdbcc8ea8fe621dae2423b10e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8327731877e08c333145ee981160210a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a8327731877e08c333145ee981160210a">br_gcm_init</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#a8934ac58af503220bfb6e6cbc2cfb209">br_block_ctr_class</a> **bctx, <a class="el" href="ssl_2bearssl_2inc_2bearssl__hash_8h.html#a06b9d6420d8038e78efbb53fb4a26eae">br_ghash</a> gh)</td></tr>
<tr class="memdesc:a8327731877e08c333145ee981160210a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a GCM context.  <a href="#a8327731877e08c333145ee981160210a">More...</a><br /></td></tr>
<tr class="separator:a8327731877e08c333145ee981160210a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73538c634b2825886f481d378619f76a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a">br_gcm_reset</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *iv, size_t len)</td></tr>
<tr class="memdesc:a73538c634b2825886f481d378619f76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a GCM context.  <a href="#a73538c634b2825886f481d378619f76a">More...</a><br /></td></tr>
<tr class="separator:a73538c634b2825886f481d378619f76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a0d62f110f27cd3b59e4b4c5c0c52a98f">br_gcm_aad_inject</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *data, size_t len)</td></tr>
<tr class="memdesc:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject additional authenticated data into GCM.  <a href="#a0d62f110f27cd3b59e4b4c5c0c52a98f">More...</a><br /></td></tr>
<tr class="separator:a0d62f110f27cd3b59e4b4c5c0c52a98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea28ef8cd39d21b2be2110d80390903"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#acea28ef8cd39d21b2be2110d80390903">br_gcm_flip</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx)</td></tr>
<tr class="memdesc:acea28ef8cd39d21b2be2110d80390903"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish injection of additional authenticated data into GCM.  <a href="#acea28ef8cd39d21b2be2110d80390903">More...</a><br /></td></tr>
<tr class="separator:acea28ef8cd39d21b2be2110d80390903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d1304725168ed2c4efa1bc58aef56ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a5d1304725168ed2c4efa1bc58aef56ea">br_gcm_run</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, int encrypt, void *data, size_t len)</td></tr>
<tr class="memdesc:a5d1304725168ed2c4efa1bc58aef56ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt some data with GCM.  <a href="#a5d1304725168ed2c4efa1bc58aef56ea">More...</a><br /></td></tr>
<tr class="separator:a5d1304725168ed2c4efa1bc58aef56ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c0b986a690b91966627dd53b9b60af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#ae7c0b986a690b91966627dd53b9b60af">br_gcm_get_tag</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, void *tag)</td></tr>
<tr class="memdesc:ae7c0b986a690b91966627dd53b9b60af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute GCM authentication tag.  <a href="#ae7c0b986a690b91966627dd53b9b60af">More...</a><br /></td></tr>
<tr class="separator:ae7c0b986a690b91966627dd53b9b60af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#aa2db733cfaf0aeaf61f1a3a375e8d860">br_gcm_check_tag</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag)</td></tr>
<tr class="memdesc:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check GCM authentication tag.  <a href="#aa2db733cfaf0aeaf61f1a3a375e8d860">More...</a><br /></td></tr>
<tr class="separator:aa2db733cfaf0aeaf61f1a3a375e8d860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0217d2166e701a8622797289eb02530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#ae0217d2166e701a8622797289eb02530">br_gcm_get_tag_trunc</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, void *tag, size_t len)</td></tr>
<tr class="memdesc:ae0217d2166e701a8622797289eb02530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute GCM authentication tag (with truncation).  <a href="#ae0217d2166e701a8622797289eb02530">More...</a><br /></td></tr>
<tr class="separator:ae0217d2166e701a8622797289eb02530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625f24f07e45a064e0a61d2dc78105e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a625f24f07e45a064e0a61d2dc78105e0">br_gcm_check_tag_trunc</a> (<a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag, size_t len)</td></tr>
<tr class="memdesc:a625f24f07e45a064e0a61d2dc78105e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check GCM authentication tag (with truncation).  <a href="#a625f24f07e45a064e0a61d2dc78105e0">More...</a><br /></td></tr>
<tr class="separator:a625f24f07e45a064e0a61d2dc78105e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa65a8ba4bdd4546ac4a3a6515fdb9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a0aa65a8ba4bdd4546ac4a3a6515fdb9a">br_eax_init</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **bctx)</td></tr>
<tr class="memdesc:a0aa65a8ba4bdd4546ac4a3a6515fdb9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize an EAX context.  <a href="#a0aa65a8ba4bdd4546ac4a3a6515fdb9a">More...</a><br /></td></tr>
<tr class="separator:a0aa65a8ba4bdd4546ac4a3a6515fdb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f0ad1260aee73650513aaba7f6848e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a20f0ad1260aee73650513aaba7f6848e">br_eax_capture</a> (<a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="structbr__eax__state.html">br_eax_state</a> *st)</td></tr>
<tr class="memdesc:a20f0ad1260aee73650513aaba7f6848e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capture pre-AAD state.  <a href="#a20f0ad1260aee73650513aaba7f6848e">More...</a><br /></td></tr>
<tr class="separator:a20f0ad1260aee73650513aaba7f6848e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51eb28308c4e2f60d7f384025213d1c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2">br_eax_reset</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *nonce, size_t len)</td></tr>
<tr class="memdesc:a51eb28308c4e2f60d7f384025213d1c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset an EAX context.  <a href="#a51eb28308c4e2f60d7f384025213d1c2">More...</a><br /></td></tr>
<tr class="separator:a51eb28308c4e2f60d7f384025213d1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb22e209ae1a508fbfadc0313a7f8435"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#aeb22e209ae1a508fbfadc0313a7f8435">br_eax_reset_pre_aad</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__state.html">br_eax_state</a> *st, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *nonce, size_t len)</td></tr>
<tr class="memdesc:aeb22e209ae1a508fbfadc0313a7f8435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset an EAX context with a pre-AAD captured state.  <a href="#aeb22e209ae1a508fbfadc0313a7f8435">More...</a><br /></td></tr>
<tr class="separator:aeb22e209ae1a508fbfadc0313a7f8435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7135b0752edf04bfc41c615c7f8ed7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#ad7135b0752edf04bfc41c615c7f8ed7f">br_eax_reset_post_aad</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__state.html">br_eax_state</a> *st, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *nonce, size_t len)</td></tr>
<tr class="memdesc:ad7135b0752edf04bfc41c615c7f8ed7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset an EAX context with a post-AAD captured state.  <a href="#ad7135b0752edf04bfc41c615c7f8ed7f">More...</a><br /></td></tr>
<tr class="separator:ad7135b0752edf04bfc41c615c7f8ed7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a070dbbdd5e22ba54fafd160107ae70d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a070dbbdd5e22ba54fafd160107ae70d6">br_eax_aad_inject</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *data, size_t len)</td></tr>
<tr class="memdesc:a070dbbdd5e22ba54fafd160107ae70d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject additional authenticated data into EAX.  <a href="#a070dbbdd5e22ba54fafd160107ae70d6">More...</a><br /></td></tr>
<tr class="separator:a070dbbdd5e22ba54fafd160107ae70d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7acb7cc559adddd9cbba8942f65a1a5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b">br_eax_flip</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx)</td></tr>
<tr class="memdesc:a7acb7cc559adddd9cbba8942f65a1a5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish injection of additional authenticated data into EAX.  <a href="#a7acb7cc559adddd9cbba8942f65a1a5b">More...</a><br /></td></tr>
<tr class="separator:a7acb7cc559adddd9cbba8942f65a1a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ec75ad8359c20eb3100cc414da990df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a7ec75ad8359c20eb3100cc414da990df">br_eax_run</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, int encrypt, void *data, size_t len)</td></tr>
<tr class="memdesc:a7ec75ad8359c20eb3100cc414da990df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt some data with EAX.  <a href="#a7ec75ad8359c20eb3100cc414da990df">More...</a><br /></td></tr>
<tr class="separator:a7ec75ad8359c20eb3100cc414da990df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694f08df7efd80be613f1d650dfc5804"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a694f08df7efd80be613f1d650dfc5804">br_eax_get_tag</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, void *tag)</td></tr>
<tr class="memdesc:a694f08df7efd80be613f1d650dfc5804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute EAX authentication tag.  <a href="#a694f08df7efd80be613f1d650dfc5804">More...</a><br /></td></tr>
<tr class="separator:a694f08df7efd80be613f1d650dfc5804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083abac4daa55b342804c559ef83dc0c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a083abac4daa55b342804c559ef83dc0c">br_eax_check_tag</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag)</td></tr>
<tr class="memdesc:a083abac4daa55b342804c559ef83dc0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check EAX authentication tag.  <a href="#a083abac4daa55b342804c559ef83dc0c">More...</a><br /></td></tr>
<tr class="separator:a083abac4daa55b342804c559ef83dc0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae580a9c43dba119ee85ca8c8b022c062"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#ae580a9c43dba119ee85ca8c8b022c062">br_eax_get_tag_trunc</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, void *tag, size_t len)</td></tr>
<tr class="memdesc:ae580a9c43dba119ee85ca8c8b022c062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute EAX authentication tag (with truncation).  <a href="#ae580a9c43dba119ee85ca8c8b022c062">More...</a><br /></td></tr>
<tr class="separator:ae580a9c43dba119ee85ca8c8b022c062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d877342f67623c30240d612cd22bff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a69d877342f67623c30240d612cd22bff">br_eax_check_tag_trunc</a> (<a class="el" href="structbr__eax__context.html">br_eax_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag, size_t len)</td></tr>
<tr class="memdesc:a69d877342f67623c30240d612cd22bff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check EAX authentication tag (with truncation).  <a href="#a69d877342f67623c30240d612cd22bff">More...</a><br /></td></tr>
<tr class="separator:a69d877342f67623c30240d612cd22bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66bdfa65912ada1090e19c270f8d4e52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a66bdfa65912ada1090e19c270f8d4e52">br_ccm_init</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **bctx)</td></tr>
<tr class="memdesc:a66bdfa65912ada1090e19c270f8d4e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a CCM context.  <a href="#a66bdfa65912ada1090e19c270f8d4e52">More...</a><br /></td></tr>
<tr class="separator:a66bdfa65912ada1090e19c270f8d4e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4">br_ccm_reset</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *nonce, size_t nonce_len, <a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a> aad_len, <a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a> data_len, size_t tag_len)</td></tr>
<tr class="memdesc:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a CCM context.  <a href="#a3e51083f8533fdd7252df6a0f66ab3a4">More...</a><br /></td></tr>
<tr class="separator:a3e51083f8533fdd7252df6a0f66ab3a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">br_ccm_aad_inject</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *data, size_t len)</td></tr>
<tr class="memdesc:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject additional authenticated data into CCM.  <a href="#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">More...</a><br /></td></tr>
<tr class="separator:aa52c5f9c1ba4eb7ab7ecdf682cbafb38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#ace507b6c8e6481f2fa5605e9e5ceea84">br_ccm_flip</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx)</td></tr>
<tr class="memdesc:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish injection of additional authenticated data into CCM.  <a href="#ace507b6c8e6481f2fa5605e9e5ceea84">More...</a><br /></td></tr>
<tr class="separator:ace507b6c8e6481f2fa5605e9e5ceea84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541acfeac63435ca9bc8c126e3dda3fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a541acfeac63435ca9bc8c126e3dda3fe">br_ccm_run</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, int encrypt, void *data, size_t len)</td></tr>
<tr class="memdesc:a541acfeac63435ca9bc8c126e3dda3fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt or decrypt some data with CCM.  <a href="#a541acfeac63435ca9bc8c126e3dda3fe">More...</a><br /></td></tr>
<tr class="separator:a541acfeac63435ca9bc8c126e3dda3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadde45697aa11481a98fee09791bb8f2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#aadde45697aa11481a98fee09791bb8f2">br_ccm_get_tag</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, void *tag)</td></tr>
<tr class="memdesc:aadde45697aa11481a98fee09791bb8f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute CCM authentication tag.  <a href="#aadde45697aa11481a98fee09791bb8f2">More...</a><br /></td></tr>
<tr class="separator:aadde45697aa11481a98fee09791bb8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bff5243ede843f8a04e98521cfd007b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a4bff5243ede843f8a04e98521cfd007b">br_ccm_check_tag</a> (<a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *ctx, <a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *tag)</td></tr>
<tr class="memdesc:a4bff5243ede843f8a04e98521cfd007b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and check CCM authentication tag.  <a href="#a4bff5243ede843f8a04e98521cfd007b">More...</a><br /></td></tr>
<tr class="separator:a4bff5243ede843f8a04e98521cfd007b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2044a9a96fb01fb0e202a1ebcc85ba8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a2044a9a96fb01fb0e202a1ebcc85ba8d">br_gcm_vtable</a></td></tr>
<tr class="memdesc:a2044a9a96fb01fb0e202a1ebcc85ba8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class instance for GCM.  <a href="#a2044a9a96fb01fb0e202a1ebcc85ba8d">More...</a><br /></td></tr>
<tr class="separator:a2044a9a96fb01fb0e202a1ebcc85ba8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a1e68cb3cacbb3a7a7e643d038c8cc5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl_2bearssl_2inc_2bearssl__aead_8h.html#a1a1e68cb3cacbb3a7a7e643d038c8cc5">br_eax_vtable</a></td></tr>
<tr class="memdesc:a1a1e68cb3cacbb3a7a7e643d038c8cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class instance for EAX.  <a href="#a1a1e68cb3cacbb3a7a7e643d038c8cc5">More...</a><br /></td></tr>
<tr class="separator:a1a1e68cb3cacbb3a7a7e643d038c8cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a80c48efdbcc8ea8fe621dae2423b10e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80c48efdbcc8ea8fe621dae2423b10e3">&#9670;&nbsp;</a></span>br_aead_class</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structbr__aead__class__.html">br_aead_class_</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Class type of an AEAD algorithm. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa52c5f9c1ba4eb7ab7ecdf682cbafb38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa52c5f9c1ba4eb7ab7ecdf682cbafb38">&#9670;&nbsp;</a></span>br_ccm_aad_inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_aad_inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject additional authenticated data into CCM. </p>
<p>The provided data is injected into a running CCM computation. Additional data must be injected <em>before</em> the call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ace507b6c8e6481f2fa5605e9e5ceea84" title="Finish injection of additional authenticated data into CCM.">br_ccm_flip()</a></code>. Additional data can be injected in several chunks of arbitrary length, but the total amount MUST exactly match the value which was provided to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">data</td><td>pointer to additional authenticated data. </td></tr>
    <tr><td class="paramname">len</td><td>length of additional authenticated data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4bff5243ede843f8a04e98521cfd007b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bff5243ede843f8a04e98521cfd007b">&#9670;&nbsp;</a></span>br_ccm_check_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_ccm_check_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check CCM authentication tag. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#aadde45697aa11481a98fee09791bb8f2" title="Compute CCM authentication tag.">br_ccm_get_tag()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with (up to 16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="ace507b6c8e6481f2fa5605e9e5ceea84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace507b6c8e6481f2fa5605e9e5ceea84">&#9670;&nbsp;</a></span>br_ccm_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_flip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish injection of additional authenticated data into CCM. </p>
<p>This function MUST be called before beginning the actual encryption or decryption (with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a541acfeac63435ca9bc8c126e3dda3fe" title="Encrypt or decrypt some data with CCM.">br_ccm_run()</a></code>), even if no additional authenticated data was injected. No additional authenticated data may be injected after this function call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aadde45697aa11481a98fee09791bb8f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadde45697aa11481a98fee09791bb8f2">&#9670;&nbsp;</a></span>br_ccm_get_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t br_ccm_get_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute CCM authentication tag. </p>
<p>Compute the CCM authentication tag. This call terminates the CCM run: all data must have been injected with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a541acfeac63435ca9bc8c126e3dda3fe" title="Encrypt or decrypt some data with CCM.">br_ccm_run()</a></code> (in zero, one or more successive calls). After this function has been called, no more data can br processed; a <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> call is required to start a new message.</p>
<p>The tag length was provided upon context initialisation (last call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code>); it is returned by this function.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a4bff5243ede843f8a04e98521cfd007b" title="Compute and check CCM authentication tag.">br_ccm_check_tag()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag (up to 16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the tag length (in bytes). </dd></dl>

</div>
</div>
<a id="a66bdfa65912ada1090e19c270f8d4e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66bdfa65912ada1090e19c270f8d4e52">&#9670;&nbsp;</a></span>br_ccm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **&#160;</td>
          <td class="paramname"><em>bctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a CCM context. </p>
<p>A block cipher implementation, with its initialised context structure, is provided. The block cipher MUST use 16-byte blocks in CTR + CBC-MAC mode, and its secret key MUST have been already set in the provided context. The parameters are linked in the CCM context.</p>
<p>After this function has been called, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> function must be called, to provide the nonce for CCM computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">bctx</td><td>block cipher context (already initialised with secret key). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3e51083f8533fdd7252df6a0f66ab3a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e51083f8533fdd7252df6a0f66ab3a4">&#9670;&nbsp;</a></span>br_ccm_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int br_ccm_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nonce_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a>&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a747748dd98cf1e2e89eb8b1fa37113df">uint64_t</a>&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a CCM context. </p>
<p>This function resets an already initialised CCM context for a new computation run. Implementations and keys are conserved. This function can be called at any time; it cancels any ongoing CCM computation that uses the provided context structure.</p>
<p>The <code>aad_len</code> parameter contains the total length, in bytes, of the additional authenticated data. It may be zero. That length MUST be exact.</p>
<p>The <code>data_len</code> parameter contains the total length, in bytes, of the data that will be injected (plaintext or ciphertext). That length MUST be exact. Moreover, that length MUST be less than 2^(8*(15-nonce_len)).</p>
<p>The nonce length (<code>nonce_len</code>), in bytes, must be in the 7..13 range (inclusive).</p>
<p>The tag length (<code>tag_len</code>), in bytes, must be in the 4..16 range, and be an even integer. Short tags mechanically allow for higher forgery probabilities; hence, tag sizes smaller than 12 bytes shall be used only with care.</p>
<p>It is critical to CCM security that nonce values are not repeated for the same encryption key. Random generation of nonces is not generally recommended, due to the relatively small maximum nonce value.</p>
<p>Returned value is 1 on success, 0 on error. An error is reported if the tag or nonce length is out of range, or if the plaintext/ciphertext length cannot be encoded with the specified nonce length.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">nonce</td><td>CCM nonce to use. </td></tr>
    <tr><td class="paramname">nonce_len</td><td>CCM nonce length (in bytes, 7 to 13). </td></tr>
    <tr><td class="paramname">aad_len</td><td>additional authenticated data length (in bytes). </td></tr>
    <tr><td class="paramname">data_len</td><td>plaintext/ciphertext length (in bytes). </td></tr>
    <tr><td class="paramname">tag_len</td><td>tag length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success, 0 on error. </dd></dl>

</div>
</div>
<a id="a541acfeac63435ca9bc8c126e3dda3fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a541acfeac63435ca9bc8c126e3dda3fe">&#9670;&nbsp;</a></span>br_ccm_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_ccm_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__ccm__context.html">br_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt some data with CCM. </p>
<p>Data encryption or decryption can be done after <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ace507b6c8e6481f2fa5605e9e5ceea84" title="Finish injection of additional authenticated data into CCM.">br_ccm_flip()</a></code> has been called on the context. If <code>encrypt</code> is non-zero, then the provided data shall be plaintext, and it is encrypted in place. Otherwise, the data shall be ciphertext, and it is decrypted in place.</p>
<p>Data may be provided in several chunks of arbitrary length, provided that the total length exactly matches the length provided to the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a3e51083f8533fdd7252df6a0f66ab3a4" title="Reset a CCM context.">br_ccm_reset()</a></code> call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context structure. </td></tr>
    <tr><td class="paramname">encrypt</td><td>non-zero for encryption, zero for decryption. </td></tr>
    <tr><td class="paramname">data</td><td>data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">len</td><td>data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a070dbbdd5e22ba54fafd160107ae70d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a070dbbdd5e22ba54fafd160107ae70d6">&#9670;&nbsp;</a></span>br_eax_aad_inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_aad_inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject additional authenticated data into EAX. </p>
<p>The provided data is injected into a running EAX computation. Additional data must be injected <em>before</em> the call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b" title="Finish injection of additional authenticated data into EAX.">br_eax_flip()</a></code>. Additional data can be injected in several chunks of arbitrary length; the total amount of additional authenticated data is unlimited.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">data</td><td>pointer to additional authenticated data. </td></tr>
    <tr><td class="paramname">len</td><td>length of additional authenticated data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20f0ad1260aee73650513aaba7f6848e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f0ad1260aee73650513aaba7f6848e">&#9670;&nbsp;</a></span>br_eax_capture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_capture </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbr__eax__state.html">br_eax_state</a> *&#160;</td>
          <td class="paramname"><em>st</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Capture pre-AAD state. </p>
<p>This function precomputes key-dependent data, and stores it in the provided <code>st</code> structure. This structure should then be used with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#aeb22e209ae1a508fbfadc0313a7f8435" title="Reset an EAX context with a pre-AAD captured state.">br_eax_reset_pre_aad()</a></code>, or updated with <code>br_eax_get_aad_mac()</code> and then used with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ad7135b0752edf04bfc41c615c7f8ed7f" title="Reset an EAX context with a post-AAD captured state.">br_eax_reset_post_aad()</a></code>.</p>
<p>The EAX context structure is unmodified by this call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">st</td><td>recipient for captured state. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a083abac4daa55b342804c559ef83dc0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083abac4daa55b342804c559ef83dc0c">&#9670;&nbsp;</a></span>br_eax_check_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_eax_check_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check EAX authentication tag. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a694f08df7efd80be613f1d650dfc5804" title="Compute EAX authentication tag.">br_eax_get_tag()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with (16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="a69d877342f67623c30240d612cd22bff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d877342f67623c30240d612cd22bff">&#9670;&nbsp;</a></span>br_eax_check_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_eax_check_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check EAX authentication tag (with truncation). </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae580a9c43dba119ee85ca8c8b022c062" title="Compute EAX authentication tag (with truncation).">br_eax_get_tag_trunc()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<p>Tag length MUST be 16 bytes or less. The normal EAX tag length is 16 bytes. See <code>br_check_tag_trunc()</code> for some discussion on the potential perils of truncating authentication tags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="a7acb7cc559adddd9cbba8942f65a1a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7acb7cc559adddd9cbba8942f65a1a5b">&#9670;&nbsp;</a></span>br_eax_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_flip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish injection of additional authenticated data into EAX. </p>
<p>This function MUST be called before beginning the actual encryption or decryption (with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7ec75ad8359c20eb3100cc414da990df" title="Encrypt or decrypt some data with EAX.">br_eax_run()</a></code>), even if no additional authenticated data was injected. No additional authenticated data may be injected after this function call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a694f08df7efd80be613f1d650dfc5804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694f08df7efd80be613f1d650dfc5804">&#9670;&nbsp;</a></span>br_eax_get_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_get_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute EAX authentication tag. </p>
<p>Compute the EAX authentication tag. The tag is a 16-byte value which is written in the provided <code>tag</code> buffer. This call terminates the EAX run: no data may be processed with that EAX context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2" title="Reset an EAX context.">br_eax_reset()</a></code> is called to initiate a new EAX run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a083abac4daa55b342804c559ef83dc0c" title="Compute and check EAX authentication tag.">br_eax_check_tag()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag (16 bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae580a9c43dba119ee85ca8c8b022c062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae580a9c43dba119ee85ca8c8b022c062">&#9670;&nbsp;</a></span>br_eax_get_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_get_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute EAX authentication tag (with truncation). </p>
<p>This function is similar to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a694f08df7efd80be613f1d650dfc5804" title="Compute EAX authentication tag.">br_eax_get_tag()</a></code>, except that it allows the tag to be truncated to a smaller length. The intended tag length is provided as <code>len</code> (in bytes); it MUST be no more than 16, but it may be smaller. Note that decreasing tag length mechanically makes forgeries easier; NIST SP 800-38D specifies that the tag length shall lie between 12 and 16 bytes (inclusive), but may be truncated down to 4 or 8 bytes, for specific applications that can tolerate it. It must also be noted that successful forgeries leak information on the authentication key, making subsequent forgeries easier. Therefore, tag truncation, and in particular truncation to sizes lower than 12 bytes, shall be envisioned only with great care.</p>
<p>The tag is written in the provided <code>tag</code> buffer. This call terminates the EAX run: no data may be processed with that EAX context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2" title="Reset an EAX context.">br_eax_reset()</a></code> is called to initiate a new EAX run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a69d877342f67623c30240d612cd22bff" title="Compute and check EAX authentication tag (with truncation).">br_eax_check_tag_trunc()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (16 bytes or less). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0aa65a8ba4bdd4546ac4a3a6515fdb9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aa65a8ba4bdd4546ac4a3a6515fdb9a">&#9670;&nbsp;</a></span>br_eax_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#acc35dad952fda67b68df0b107fe26f0b">br_block_ctrcbc_class</a> **&#160;</td>
          <td class="paramname"><em>bctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize an EAX context. </p>
<p>A block cipher implementation, with its initialised context structure, is provided. The block cipher MUST use 16-byte blocks in CTR + CBC-MAC mode, and its secret key MUST have been already set in the provided context. The parameters are linked in the EAX context.</p>
<p>After this function has been called, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2" title="Reset an EAX context.">br_eax_reset()</a></code> function must be called, to provide the nonce for EAX computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">bctx</td><td>block cipher context (already initialised with secret key). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a51eb28308c4e2f60d7f384025213d1c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51eb28308c4e2f60d7f384025213d1c2">&#9670;&nbsp;</a></span>br_eax_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset an EAX context. </p>
<p>This function resets an already initialised EAX context for a new computation run. Implementations and keys are conserved. This function can be called at any time; it cancels any ongoing EAX computation that uses the provided context structure.</p>
<p>It is critical to EAX security that nonce values are not repeated for the same encryption key. Nonces can have arbitrary length. If nonces are randomly generated, then a nonce length of at least 128 bits (16 bytes) is recommended, to make nonce reuse probability sufficiently low.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">nonce</td><td>EAX nonce to use. </td></tr>
    <tr><td class="paramname">len</td><td>EAX nonce length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad7135b0752edf04bfc41c615c7f8ed7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7135b0752edf04bfc41c615c7f8ed7f">&#9670;&nbsp;</a></span>br_eax_reset_post_aad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_reset_post_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__state.html">br_eax_state</a> *&#160;</td>
          <td class="paramname"><em>st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset an EAX context with a post-AAD captured state. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2" title="Reset an EAX context.">br_eax_reset()</a></code>, that reuses a previously captured state structure for lower per-message overhead. The state should have been populated with <code>br_eax_capture_state()</code> and then updated with <code>br_eax_get_aad_mac()</code>.</p>
<p>After this function is called, message data MUST be injected. The <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b" title="Finish injection of additional authenticated data into EAX.">br_eax_flip()</a></code> function MUST NOT be called. At least one byte of message data MUST be provided with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7ec75ad8359c20eb3100cc414da990df" title="Encrypt or decrypt some data with EAX.">br_eax_run()</a></code>; empty messages are not supported with this reset mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">st</td><td>post-AAD captured state. </td></tr>
    <tr><td class="paramname">nonce</td><td>EAX nonce to use. </td></tr>
    <tr><td class="paramname">len</td><td>EAX nonce length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeb22e209ae1a508fbfadc0313a7f8435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb22e209ae1a508fbfadc0313a7f8435">&#9670;&nbsp;</a></span>br_eax_reset_pre_aad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_reset_pre_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="structbr__eax__state.html">br_eax_state</a> *&#160;</td>
          <td class="paramname"><em>st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset an EAX context with a pre-AAD captured state. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a51eb28308c4e2f60d7f384025213d1c2" title="Reset an EAX context.">br_eax_reset()</a></code>, that reuses a previously captured state structure for lower per-message overhead. The state should have been populated with <code>br_eax_capture_state()</code> but not updated with <code>br_eax_get_aad_mac()</code>.</p>
<p>After this function is called, additional authenticated data MUST be injected. At least one byte of additional authenticated data MUST be provided with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a070dbbdd5e22ba54fafd160107ae70d6" title="Inject additional authenticated data into EAX.">br_eax_aad_inject()</a></code>; computation result will be incorrect if <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b" title="Finish injection of additional authenticated data into EAX.">br_eax_flip()</a></code> is called right away.</p>
<p>After injection of the AAD and call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b" title="Finish injection of additional authenticated data into EAX.">br_eax_flip()</a></code>, at least one message byte must be provided. Empty messages are not supported with this reset mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">st</td><td>pre-AAD captured state. </td></tr>
    <tr><td class="paramname">nonce</td><td>EAX nonce to use. </td></tr>
    <tr><td class="paramname">len</td><td>EAX nonce length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7ec75ad8359c20eb3100cc414da990df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ec75ad8359c20eb3100cc414da990df">&#9670;&nbsp;</a></span>br_eax_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_eax_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__eax__context.html">br_eax_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt some data with EAX. </p>
<p>Data encryption or decryption can be done after <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a7acb7cc559adddd9cbba8942f65a1a5b" title="Finish injection of additional authenticated data into EAX.">br_eax_flip()</a></code> has been called on the context. If <code>encrypt</code> is non-zero, then the provided data shall be plaintext, and it is encrypted in place. Otherwise, the data shall be ciphertext, and it is decrypted in place.</p>
<p>Data may be provided in several chunks of arbitrary length.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>EAX context structure. </td></tr>
    <tr><td class="paramname">encrypt</td><td>non-zero for encryption, zero for decryption. </td></tr>
    <tr><td class="paramname">data</td><td>data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">len</td><td>data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0d62f110f27cd3b59e4b4c5c0c52a98f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d62f110f27cd3b59e4b4c5c0c52a98f">&#9670;&nbsp;</a></span>br_gcm_aad_inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_aad_inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject additional authenticated data into GCM. </p>
<p>The provided data is injected into a running GCM computation. Additional data must be injected <em>before</em> the call to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#acea28ef8cd39d21b2be2110d80390903" title="Finish injection of additional authenticated data into GCM.">br_gcm_flip()</a></code>. Additional data can be injected in several chunks of arbitrary length; the maximum total size of additional authenticated data is 2^64-1 bits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">data</td><td>pointer to additional authenticated data. </td></tr>
    <tr><td class="paramname">len</td><td>length of additional authenticated data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa2db733cfaf0aeaf61f1a3a375e8d860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2db733cfaf0aeaf61f1a3a375e8d860">&#9670;&nbsp;</a></span>br_gcm_check_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_gcm_check_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check GCM authentication tag. </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae7c0b986a690b91966627dd53b9b60af" title="Compute GCM authentication tag.">br_gcm_get_tag()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with (16 bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="a625f24f07e45a064e0a61d2dc78105e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625f24f07e45a064e0a61d2dc78105e0">&#9670;&nbsp;</a></span>br_gcm_check_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a0238af00180b6d9278fa1c6aa790fdf4">uint32_t</a> br_gcm_check_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and check GCM authentication tag (with truncation). </p>
<p>This function is an alternative to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae0217d2166e701a8622797289eb02530" title="Compute GCM authentication tag (with truncation).">br_gcm_get_tag_trunc()</a></code>, normally used on the receiving end (i.e. when decrypting value). The tag value is recomputed and compared with the provided tag value. If they match, 1 is returned; on mismatch, 0 is returned. A returned value of 0 means that the data or the tag was altered in transit, normally leading to wholesale rejection of the complete message.</p>
<p>Tag length MUST be 16 bytes or less. The normal GCM tag length is 16 bytes. See <code>br_check_tag_trunc()</code> for some discussion on the potential perils of truncating authentication tags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>tag value to compare with. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (in bytes). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (exact match of tag value), 0 otherwise. </dd></dl>

</div>
</div>
<a id="acea28ef8cd39d21b2be2110d80390903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea28ef8cd39d21b2be2110d80390903">&#9670;&nbsp;</a></span>br_gcm_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_flip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish injection of additional authenticated data into GCM. </p>
<p>This function MUST be called before beginning the actual encryption or decryption (with <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a5d1304725168ed2c4efa1bc58aef56ea" title="Encrypt or decrypt some data with GCM.">br_gcm_run()</a></code>), even if no additional authenticated data was injected. No additional authenticated data may be injected after this function call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae7c0b986a690b91966627dd53b9b60af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c0b986a690b91966627dd53b9b60af">&#9670;&nbsp;</a></span>br_gcm_get_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_get_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute GCM authentication tag. </p>
<p>Compute the GCM authentication tag. The tag is a 16-byte value which is written in the provided <code>tag</code> buffer. This call terminates the GCM run: no data may be processed with that GCM context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> is called to initiate a new GCM run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#aa2db733cfaf0aeaf61f1a3a375e8d860" title="Compute and check GCM authentication tag.">br_gcm_check_tag()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag (16 bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae0217d2166e701a8622797289eb02530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0217d2166e701a8622797289eb02530">&#9670;&nbsp;</a></span>br_gcm_get_tag_trunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_get_tag_trunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute GCM authentication tag (with truncation). </p>
<p>This function is similar to <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#ae7c0b986a690b91966627dd53b9b60af" title="Compute GCM authentication tag.">br_gcm_get_tag()</a></code>, except that it allows the tag to be truncated to a smaller length. The intended tag length is provided as <code>len</code> (in bytes); it MUST be no more than 16, but it may be smaller. Note that decreasing tag length mechanically makes forgeries easier; NIST SP 800-38D specifies that the tag length shall lie between 12 and 16 bytes (inclusive), but may be truncated down to 4 or 8 bytes, for specific applications that can tolerate it. It must also be noted that successful forgeries leak information on the authentication key, making subsequent forgeries easier. Therefore, tag truncation, and in particular truncation to sizes lower than 12 bytes, shall be envisioned only with great care.</p>
<p>The tag is written in the provided <code>tag</code> buffer. This call terminates the GCM run: no data may be processed with that GCM context afterwards, until <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> is called to initiate a new GCM run.</p>
<p>The tag value must normally be sent along with the encrypted data. When decrypting, the tag value must be recomputed and compared with the received tag: if the two tag values differ, then either the tag or the encrypted data was altered in transit. As an alternative to this function, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a625f24f07e45a064e0a61d2dc78105e0" title="Compute and check GCM authentication tag (with truncation).">br_gcm_check_tag_trunc()</a></code> function can be used to compute and check the tag value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">tag</td><td>destination buffer for the tag. </td></tr>
    <tr><td class="paramname">len</td><td>tag length (16 bytes or less). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8327731877e08c333145ee981160210a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8327731877e08c333145ee981160210a">&#9670;&nbsp;</a></span>br_gcm_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__block_8h.html#a8934ac58af503220bfb6e6cbc2cfb209">br_block_ctr_class</a> **&#160;</td>
          <td class="paramname"><em>bctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ssl_2bearssl_2inc_2bearssl__hash_8h.html#a06b9d6420d8038e78efbb53fb4a26eae">br_ghash</a>&#160;</td>
          <td class="paramname"><em>gh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a GCM context. </p>
<p>A block cipher implementation, with its initialised context structure, is provided. The block cipher MUST use 16-byte blocks in CTR mode, and its secret key MUST have been already set in the provided context. A GHASH implementation must also be provided. The parameters are linked in the GCM context.</p>
<p>After this function has been called, the <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a73538c634b2825886f481d378619f76a" title="Reset a GCM context.">br_gcm_reset()</a></code> function must be called, to provide the IV for GCM computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">bctx</td><td>block cipher context (already initialised with secret key). </td></tr>
    <tr><td class="paramname">gh</td><td>GHASH implementation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a73538c634b2825886f481d378619f76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73538c634b2825886f481d378619f76a">&#9670;&nbsp;</a></span>br_gcm_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a GCM context. </p>
<p>This function resets an already initialised GCM context for a new computation run. Implementations and keys are conserved. This function can be called at any time; it cancels any ongoing GCM computation that uses the provided context structure.</p>
<p>The provided IV is a <em>nonce</em>. It is critical to GCM security that IV values are not repeated for the same encryption key. IV can have arbitrary length (up to 2^64-1 bits), but the "normal" length is 96 bits (12 bytes).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">iv</td><td>GCM nonce to use. </td></tr>
    <tr><td class="paramname">len</td><td>GCM nonce length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5d1304725168ed2c4efa1bc58aef56ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d1304725168ed2c4efa1bc58aef56ea">&#9670;&nbsp;</a></span>br_gcm_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void br_gcm_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbr__gcm__context.html">br_gcm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt or decrypt some data with GCM. </p>
<p>Data encryption or decryption can be done after <code><a class="el" href="include_2bearssl_2bearssl__aead_8h.html#acea28ef8cd39d21b2be2110d80390903" title="Finish injection of additional authenticated data into GCM.">br_gcm_flip()</a></code> has been called on the context. If <code>encrypt</code> is non-zero, then the provided data shall be plaintext, and it is encrypted in place. Otherwise, the data shall be ciphertext, and it is decrypted in place.</p>
<p>Data may be provided in several chunks of arbitrary length. The maximum total length for data is 2^39-256 bits, i.e. about 65 gigabytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>GCM context structure. </td></tr>
    <tr><td class="paramname">encrypt</td><td>non-zero for encryption, zero for decryption. </td></tr>
    <tr><td class="paramname">data</td><td>data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">len</td><td>data length (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1a1e68cb3cacbb3a7a7e643d038c8cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a1e68cb3cacbb3a7a7e643d038c8cc5">&#9670;&nbsp;</a></span>br_eax_vtable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a> br_eax_vtable</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Class instance for EAX. </p>

</div>
</div>
<a id="a2044a9a96fb01fb0e202a1ebcc85ba8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2044a9a96fb01fb0e202a1ebcc85ba8d">&#9670;&nbsp;</a></span>br_gcm_vtable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cdefs_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> <a class="el" href="include_2bearssl_2bearssl__aead_8h.html#a80c48efdbcc8ea8fe621dae2423b10e3">br_aead_class</a> br_gcm_vtable</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Class instance for GCM. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
